#!/usr/bin/lua
--******************************************************************************
net = require("luanet")

--==============================================================================
-- Global Definitions
--==============================================================================
loopip = "127.0.0.1"  -- Loopback IP address
uport = 1026  -- UDP port, taken from ds11.common/usr/include/dsinetports.h

--==============================================================================
-- Command-line arguments
--==============================================================================
msg = arg[1]

--==============================================================================
-- Create and initialize a Socket.
--==============================================================================
soc = net.socket("udp")
if soc == nil then
  print("ERROR: failed to open socket")
  os.exit()
end
ecode = net.setsockopt(soc, "reuseaddr", "on")
if ecode == nil then
  print("ERROR: setsockopt(reuseaddr) failed")
  os.exit()
end
--==============================================================================
-- Send a Message.
--==============================================================================
nsend = net.sendto(soc, msg, loopip, uport)

--==============================================================================
-- Exit
--==============================================================================
net.close(soc)

